(function(){"use strict";var t={9031:function(t,e,r){var o=r(6848),n=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("link",{attrs:{rel:"stylesheet",href:"https://use.fontawesome.com/releases/v5.15.4/css/all.css",integrity:"sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm",crossorigin:"anonymous"}}),e("link",{attrs:{rel:"manifest",href:"afterschool.webmanifest"}}),e("header",[e("h1",[t._v(t._s(t.sitename))]),""==t.cartItemCount?e("p",{staticStyle:{opacity:"0.5"},attrs:{disabled:"disabled",id:"checkoutBtn"}},[t._v(" "+t._s(t.cartItemCount)+" "),e("span",{staticClass:"fas fa-cart-plus"})]):e("p",{attrs:{id:"checkoutBtn"},on:{click:t.showCheckout}},[t._v(" "+t._s(t.cartItemCount)+" "),e("span",{staticClass:"fas fa-cart-plus"})])]),e("main",[t.showProduct?e("div",[e("div",{attrs:{id:"mainProductContainer"}},[e("div",{attrs:{id:"sideContainer"}},[e("p",[t._v("Search:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],attrs:{id:"searchbar",type:"search",placeholder:"Search"},domProps:{value:t.searchInput},on:{input:[function(e){e.target.composing||(t.searchInput=e.target.value)},t.searchResults]}}),e("br"),e("p",[t._v("Sort By:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.sortby,expression:"sortby"}],attrs:{type:"radio",id:"class",value:"class"},domProps:{checked:t._q(t.sortby,"class")},on:{change:function(e){t.sortby="class"}}}),e("label",{attrs:{for:"class"}},[t._v("Class")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.sortby,expression:"sortby"}],attrs:{type:"radio",id:"location",value:"location"},domProps:{checked:t._q(t.sortby,"location")},on:{change:function(e){t.sortby="location"}}}),e("label",{attrs:{for:"location"}},[t._v("Location")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.sortby,expression:"sortby"}],attrs:{type:"radio",id:"price",value:"price"},domProps:{checked:t._q(t.sortby,"price")},on:{change:function(e){t.sortby="price"}}}),e("label",{attrs:{for:"price"}},[t._v("Price")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.sortby,expression:"sortby"}],attrs:{type:"radio",id:"availability",value:"availability"},domProps:{checked:t._q(t.sortby,"availability")},on:{change:function(e){t.sortby="availability"}}}),e("label",{attrs:{for:"class"}},[t._v("Availability")]),e("br"),e("p",[t._v("Order By:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.orderby,expression:"orderby"}],attrs:{type:"radio",id:"ascending",value:"ascending"},domProps:{checked:t._q(t.orderby,"ascending")},on:{change:function(e){t.orderby="ascending"}}}),e("label",{attrs:{for:"ascending"}},[t._v("Ascending")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.orderby,expression:"orderby"}],attrs:{type:"radio",id:"descending",value:"descending"},domProps:{checked:t._q(t.orderby,"descending")},on:{change:function(e){t.orderby="descending"}}}),e("label",{attrs:{for:"descending"}},[t._v("Descending")])]),e("lesson",{attrs:{products:t.sortedProducts},on:{addProduct:t.addToCart,canAddtoCart:t.canAddToCart,cartCount:t.cartCount}})],1)]):t.cartItemCount>0?e("div",{attrs:{id:"cartCheckout"}},[e("checkout",{attrs:{cart:t.cart,products:t.products},on:{removeFromCart:t.removeFromCart,submitForm:t.submitForm}})],1):e("div",{staticStyle:{"text-align":"center"}},[e("h1",{staticStyle:{"font-size":"35px"}},[t._v("Cart")]),e("p",[t._v("No items left in cart!")])])])])},a=[],s=(r(4114),function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"productContainer"}},t._l(t.products,(function(r){return e("div",{key:r.id,attrs:{id:"productCard"}},[e("figure",[e("img",{attrs:{src:r.image}})]),e("h2",[t._v(t._s(r.title))]),e("p",[t._v("Location: "+t._s(r.location))]),e("p",[t._v("Price: AED"+t._s(r.price))]),e("p",[t._v("Availability: "+t._s(r.availableInventory))]),t.canAddToCart(r)?e("button",{on:{click:function(e){return t.add(r)}}},[t._v(" Add to Cart")]):e("button",{attrs:{disabled:"disabled"}},[t._v(" Add to Cart ")]),e("br"),r.cartInventory===t.cartCount(r.id)?e("span",[t._v(" All Out!")]):r.availableInventory<5?e("span",[t._v(" Only "+t._s(r.availableInventory)+" left!")]):e("span",[t._v("Buy Now!")])])})),0)}),i=[],c={name:"Lesson-Component",props:["products"],methods:{add(t){console.log("Added product",t.id),this.$emit("addProduct",t)},canAddToCart(t){return this.$emit("canAddToCart",t)},cartCount(t){return this.$emit("cartCount",t)}}},l=c,d=r(1656),u=(0,d.A)(l,s,i,!1,null,null,null),p=u.exports,h=function(){var t=this,e=t._self._c;return e("div",[e("h1",[t._v("Cart")]),e("div",{attrs:{id:"cartContainer"}},[e("div",{attrs:{id:"cartCardContainer"}},t._l(t.filteredProducts,(function(r){return e("div",{key:r.id,attrs:{id:"productCard"}},[e("figure",[e("img",{attrs:{src:r.image,alt:"Product Image"}})]),e("h2",[t._v(t._s(r.title))]),e("p",[t._v("Location: "+t._s(r.location))]),e("p",[t._v("Price: AED"+t._s(r.price))]),e("button",{on:{click:function(e){return t.removeItemFromCart(r)}}},[t._v(" Remove Item ")]),e("br")])})),0)]),e("div",{attrs:{id:"checkoutContainer"}},[e("h1",[t._v("Checkout")]),e("p",[e("strong",[t._v("Name:")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.order.name,expression:"order.name",modifiers:{trim:!0}}],domProps:{value:t.order.name},on:{input:function(e){e.target.composing||t.$set(t.order,"name",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),e("p",[e("strong",[t._v("Phone:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.order.phone,expression:"order.phone"}],attrs:{type:"number"},domProps:{value:t.order.phone},on:{input:function(e){e.target.composing||t.$set(t.order,"phone",e.target.value)}}})]),e("br"),e("br"),e("br"),e("h1",[t._v("Order Information")]),e("p",[t._v("Name: "+t._s(t.order.name))]),e("p",[t._v("Phone: "+t._s(t.order.phone))]),t.validateInput?e("button",{on:{click:function(e){return t.submitForm()}}},[t._v(" Place Order")]):e("button",{attrs:{disabled:"disabled"}},[t._v(" Place Order")])])])},v=[],m={name:"Checkout-Component",props:["cart","products"],data(){return{order:{name:"",phone:"",cart:this.cart}}},methods:{removeItemFromCart(t){this.$emit("removeFromCart",t)},submitForm(){console.log("clicked"),console.log(this.order),this.$emit("submitForm",this.order)}},computed:{filteredProducts(){let t=[];for(let e in this.cart)for(let r in this.products)this.products[r].id==this.cart[e]&&t.push(this.products[r]);return t},validateInput(){var t=/^[a-zA-Z]+(([',. -][a-zA-Z ])?[a-zA-Z]*)*$/g,e=/^[0-9]*$/g;return!(""==this.order.name||""==this.order.phone||!t.test(this.order.name)||!e.test(this.order.phone))}}},f=m,b=(0,d.A)(f,h,v,!1,null,null,null),y=b.exports;"serviceWorker"in navigator&&navigator.serviceWorker.register("service-worker.js");var g={name:"App",components:{lesson:p,checkout:y},data(){return{showProduct:!0,sitename:"After School Classes",products:[],cart:[],searchInput:"",sortby:"",orderby:"ascending"}},created:function(){console.log("Requesting data from server"),fetch("http://localhost:3000/collection/lessons").then((t=>t.json())).then((t=>{this.products=t,console.log(t)}))},methods:{addToCart(t){this.cart.push(t.id),t.availableInventory--},showCheckout(){this.showProduct=!this.showProduct},canAddToCart(t){return t.cartInventory>this.cartCount(t.id)},cartCount(t){let e=0;for(let r=0;r<this.cart.length;r++)this.cart[r]==t&&e++;return e},removeFromCart(t){let e=this.cart.indexOf(t.id);e>-1&&this.cart.splice(e,1),t.availableInventory++},submitForm(t){console.log(t),fetch("http://localhost:3000/collection/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>{if(!t.ok)throw new Error("Failed to place order");return t.json()})).then((t=>{console.log("Order placed successfully:",t[0]._id),this.updateLessons(),alert("Order placed successfully: "+t[0]._id),this.cart=[],location.reload()})).catch((t=>{console.error("Error placing order: ",t)}))},updateLessons(){let t=[];for(let r of Object.keys(this.cart))for(let e of this.products)this.cart[r]===e.id&&t.push(e._id);const e=t.map((t=>fetch("http://localhost:3000/collection/lessons/"+t,{method:"PUT",headers:{"Content-Type":"application/json"}}).then((t=>{if(!t.ok)throw new Error("Failed to update inventory");return t.json()})).catch((t=>{console.error("Error updating inventory",t)}))));Promise.all(e).then((()=>{console.log("All lessons updated successfully")})).catch((t=>{console.error("Error updating lessons:",t)}))},searchResults(){fetch("http://localhost:3000/collection/lessons/search?q="+this.searchInput,{method:"GET",headers:{"Content-Type":"application/json"}}).then((t=>{if(!t.ok)throw new Error("Failed to search lessons");return t.json()})).then((t=>{console.log(t),this.products=t})).catch((t=>{console.error("Error searching lessons:",t)}))}},computed:{cartItemCount:function(){return this.cart.length||""},sortedProducts:function(){let t=this.products.slice(0);function e(t,e,r,o){return"price"===r?"ascending"===o?t.price-e.price:e.price-t.price:"class"===r?"ascending"===o?t.title.localeCompare(e.title):e.title.localeCompare(t.title):"availability"===r?"ascending"===o?t.availableInventory-e.availableInventory:e.availableInventory-t.availableInventory:"location"===r?"ascending"===o?t.location.localeCompare(e.location):e.location.localeCompare(t.location):void 0}return t.sort(((t,r)=>e(t,r,this.sortby,this.orderby)))}}},_=g,C=(0,d.A)(_,n,a,!1,null,null,null),k=C.exports;o.Ay.config.productionTip=!1,new o.Ay({render:t=>t(k)}).$mount("#app")}},e={};function r(o){var n=e[o];if(void 0!==n)return n.exports;var a=e[o]={exports:{}};return t[o].call(a.exports,a,a.exports,r),a.exports}r.m=t,function(){var t=[];r.O=function(e,o,n,a){if(!o){var s=1/0;for(d=0;d<t.length;d++){o=t[d][0],n=t[d][1],a=t[d][2];for(var i=!0,c=0;c<o.length;c++)(!1&a||s>=a)&&Object.keys(r.O).every((function(t){return r.O[t](o[c])}))?o.splice(c--,1):(i=!1,a<s&&(s=a));if(i){t.splice(d--,1);var l=n();void 0!==l&&(e=l)}}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[o,n,a]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};r.O.j=function(e){return 0===t[e]};var e=function(e,o){var n,a,s=o[0],i=o[1],c=o[2],l=0;if(s.some((function(e){return 0!==t[e]}))){for(n in i)r.o(i,n)&&(r.m[n]=i[n]);if(c)var d=c(r)}for(e&&e(o);l<s.length;l++)a=s[l],r.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return r.O(d)},o=self["webpackChunkafterschoolapp"]=self["webpackChunkafterschoolapp"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(9031)}));o=r.O(o)})();
//# sourceMappingURL=app.5c73cf80.js.map